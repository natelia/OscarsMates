<header class="site-header">
  <div class="container mx-auto px-4">
    <div class="header-inner">
      <%= link_to root_path, class: "logo" do %>
        <i class="bi bi-trophy-fill"></i>
        <span>OscarsMates</span>
      <% end %>

      <button class="menu-toggle lg:hidden" type="button" data-hs-collapse="#mainNav" aria-controls="mainNav" aria-label="Toggle navigation">
        <i class="bi bi-list"></i>
      </button>

      <nav class="main-nav hs-collapse hidden lg:!flex" id="mainNav">
        <% selected_year = current_year || default_year %>

        <ul class="nav-links">
          <% if available_years.any? %>
            <li class="hs-dropdown relative">
              <button type="button" class="nav-link hs-dropdown-toggle flex items-center gap-2">
                <span><%= selected_year %> Oscars</span>
                <i class="bi bi-chevron-down text-xs opacity-60"></i>
              </button>
              <ul class="dropdown-menu hs-dropdown-menu transition-[opacity,margin] duration-200 opacity-0 hs-dropdown-open:opacity-100 hidden mt-2 w-48">
                <% available_years.each do |year| %>
                  <li><%= link_to "#{year} Awards", movies_path(year: year), class: "dropdown-item #{'active' if year == selected_year}" %></li>
                <% end %>
              </ul>
            </li>
          <% end %>
          <li><%= link_to "Mates", users_path, class: "nav-link" %></li>
          <li><%= link_to "Timeline", timeline_users_path(year: selected_year), class: "nav-link" %></li>
          <li><%= link_to "Stats", stats_users_path(year: selected_year), class: "nav-link" %></li>
          <li><%= link_to "Categories", categories_path(year: selected_year), class: "nav-link" %></li>
        </ul>

        <div class="header-actions">
          <% if current_user %>
            <div class="hs-dropdown relative">
              <button type="button" class="user-menu hs-dropdown-toggle flex items-center gap-2">
                <%= render "shared/avatar", user: current_user, size: :sm %>
                <span class="hidden md:inline"><%= current_user.name %></span>
                <i data-lucide="chevron-down" class="w-3 h-3 opacity-60"></i>
              </button>
              <ul class="dropdown-menu hs-dropdown-menu transition-[opacity,margin] duration-200 opacity-0 hs-dropdown-open:opacity-100 hidden mt-2 w-48 right-0">
                <li><%= link_to "Profile", user_path(current_user), class: "dropdown-item" %></li>
                <li><%= link_to "Settings", edit_user_path(current_user), class: "dropdown-item" %></li>
                <li><hr class="dropdown-divider"></li>
                <li><%= button_to "Sign Out", destroy_session_path, method: :delete, class: "dropdown-item", data: { turbo_method: :delete } %></li>
              </ul>
            </div>
          <% else %>
            <%= link_to "Sign In", signin_path, class: "btn-secondary-minimal" %>
            <%= link_to "Sign Up", new_user_path, class: "btn-primary-minimal" %>
          <% end %>
        </div>
      </nav>
    </div>
  </div>
</header>
